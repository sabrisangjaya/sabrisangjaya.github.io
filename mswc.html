<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sabri Sangjaya</title>
<meta name="description" content="Web Developer and Machine Learning Enthusiasts">
<meta name="keywords" content="web,developer,designer,resume,cv,sabri,sangjaya,machine,learning,data,scientist" />
<meta name="author" content="Sabri Sangjaya">
<meta property="og:image:alt" content="Sabri Sangjaya">
<meta property="og:locale" content="en_ID">
<meta name="theme-color" content="#007bff">
<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://sabrisangjaya.github.io/">
<meta property="og:title" content="Sabri Sangjaya">
<meta property="og:description" content="Web Developer and Machine Learning Enthusiasts">
<meta property="og:image" content="https://sabrisangjaya.github.io/img/webpreview.jpg">
<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://sabrisangjaya.github.io/">
<meta property="twitter:title" content="Sabri Sangjaya">
<meta property="twitter:description" content="Web Developer and Machine Learning Enthusiasts">
<meta property="twitter:image" content="https://sabrisangjaya.github.io/img/webpreview.jpg">

<link rel="icon" href="img/logo.svg" sizes="any" type="image/svg+xml">

<link rel="stylesheet" href="css/font-awesome.css">
<link rel="stylesheet" href="css/bootstrap.min.css">
<script src="js/jquery.min.js" type="text/javascript"></script>
<script src="js/popper.min.js" type="text/javascript"></script>
<script src="js/bootstrap.min.js" type="text/javascript"></script>
<link rel="alternate" href="https://sabrisangjaya.github.io/" hreflang="en-id" />
<link rel="stylesheet" href="css/index.css">
</head>
<body>



<div class="container">
<br/>
<div class="row">
	<div class="col-md-12 text-center" style="margin-bottom:10px;">
		<img src="mswc/mswc.png" height="300px" alt="movie spoiler without context"/><br/>
<form action="" id="searchmovie">
  <div class="input-group mb-3">
    <input type="text" name="q" id="moviequery" class="form-control" placeholder="Type movie name" value="">
    <div class="input-group-append">
      <button class="btn btn-success" type="submit">Go</button>
    </div>
  </div>
</form>
	</div>
<div class="col-md-12">

<div class="row" id="searchresult">

<!-- <div class="col-md-3"><div class="card"><img class="card-img-top" src="https://themoviespoiler.com/wp-content/uploads/2021/02/to_all_the_boys_always_and_forever.jpg" alt="Card image cap"><div class="card-body"><h5 class="card-title">
TO ALL THE BOYS: Always and Forever
</h5><a href="https://themoviespoiler.com/movies/to-all-the-boys-always-and-forever/" class="viewspoiler btn btn-primary">Preview</a></div></div></div>
<div class="col-md-3"><div class="card"><img class="card-img-top" src="https://themoviespoiler.com/wp-content/uploads/2020/04/to_all_the_boys_ive_loved_before_xxlg.jpg" alt="Card image cap"><div class="card-body"><h5 class="card-title">
TO ALL THE BOYS I’VE LOVED BEFORE
</h5><a href="https://themoviespoiler.com/movies/to-all-the-boys-ive-loved-before/" class="viewspoiler btn btn-primary">Preview</a></div></div></div>
<div class="col-md-3"><div class="card"><img class="card-img-top" src="https://themoviespoiler.com/wp-content/uploads/2020/04/to_all_the_boys_ps_i_still_love_you_xxlg.jpg" alt="Card image cap"><div class="card-body"><h5 class="card-title">
TO ALL THE BOYS:  P.S I Still Love You
</h5><a href="https://themoviespoiler.com/movies/to-all-the-boys-p-s-i-still-love-you/" class="viewspoiler btn btn-primary">Preview</a></div></div></div> -->

</div>
</div>
</div>
</div>
<script>

$(document).ready(function(e) {

 $('#searchmovie').on('submit', function(formevent){
 	formevent.preventDefault();
 	$("#searchresult").empty();
 	var judulfilm=$('#moviequery').val();
 	console.log(judulfilm);
	var myUrl = 'https://themoviespoiler.com/?s='+judulfilm;
	var x = new XMLHttpRequest();
	x.open('GET', ''+myUrl);
	x.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
	x.setRequestHeader("Content-Type", "text/xml");
	x.responseType = 'document';
	x.onload = function() {
		var konten="";
		Array.from(x.responseXML.getElementsByClassName("box_office_poster")).forEach(
		function(element, index, array){
			var poster=element.getElementsByClassName("post-thumbnail")[0];
			var linkpost=element.getElementsByClassName("post-thumbnail")[0].href;
			var imgposter=poster.children[0].src;
			var judul=element.getElementsByClassName("box_office_title")[0].innerHTML;
			konten+='<div class="col-md-3"><div class="card"><img class="card-img-top" src="'+imgposter+'" alt="Card image cap"><div class="card-body"><h5 class="card-title">'+judul+'</h5><a href="'+linkpost+'" class="viewspoiler btn btn-primary" data-toggle="modal" data-target="#modal">Preview</a></div></div></div>	';
		}
		);
		$("#searchresult").append(konten);
		$('.viewspoiler').on('click',function(event){
			
			var movieurl = $(this).attr("href");
			var x2 = new XMLHttpRequest();
			x2.open('GET', ''+movieurl);
			x2.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
			x2.setRequestHeader("Content-Type", "text/xml");
			x2.responseType = 'document';
			x2.onload = function() {
				console.log(x2.responseXML);
				var content = x2.responseXML.getElementsByClassName("entry-content")[0];
				var plotcontent="";
				var judulmodal=x2.responseXML.getElementsByClassName("entry-title")[0].innerHTML;
				console.log(judulmodal);
				$(".modal-title")[0].innerHTML=judulmodal;
				Array.from(content.getElementsByTagName("p")).forEach(
				function(element, index, array) {
					plotcontent+=element.innerText;
				});

				var divideplot=plotcontent.split("*CUT TO THE CHASE*\nBrought to you by\n");
				console.log(divideplot[1]);
				var moviekeywords=extractplot(divideplot[1])
				console.log(moviekeywords);
				$("#gifs").empty();
				moviekeywords.forEach(function(moviekeyword, index, array) {
					//Sets up the url that the ajax call will use
					var queryURL = "https://api.giphy.com/v1/gifs/search?q=" +
					moviekeyword + "&api_key=TTp0IyLaWoDM42yZ5R8dbuGFE36a1UFh&limit=1";
					//Ajax call
					$.ajax({
					url: queryURL,
					method: "GET"
					}).then(function (response) {
						//Stores the actual image array that is returned within a results variable for easier access down below
						var results = response.data;
						//Loops through all the images in the image array that is returned...
						for (var i = 0; i < results.length; i++) {
							//Creates a new span for each gif within the array, & also a new paragraph to store that gif's rating
							var movieSpan = $("<div class='col-md-6 movie-span'>");
							//Sets up variable to hold the code for downloading a gif
							var downloadLink = $("<a>").attr("href", results[i].images.original.url).attr("target","_blank");
							//Creates a new image tag and sets its src attribute to the url of the gif that's in question, as well as setting its dimensions
							var movieImage = $("<img class='img-fluid' style='width:100%'>");
							movieImage.attr("src", results[i].images.original.url);

							//Sets up code so that the gifs can be played or paused
							// movieImage.attr("data-state", "still");
							// movieImage.attr("data-still", results[i].images.original_still.url);
							// movieImage.attr("data-animate", results[i].images.original.url);
							//Appends the movie image & its corresponding paragraph to the movie div, as well as the gif download link, and then prepends that movie div to the main gifs div in the page
							downloadLink.append(movieImage);
							movieSpan.append(downloadLink);
							$("#gifs").prepend(movieSpan);
						}
					});
				});
				$("#modal").modal();
			};
			x2.send();
			return false;
		});
	};
	x.onerror = function() {
		var konten="";
		konten+='<div class="col-md-12"><div class="card"><div class="card-body"><h5 class="card-title">Failed to request</h5></div></div></div>	';
		$("#searchresult").append(konten);
	};
	x.send();
	
	});

});


function extractplot(movieplot) {
	var candidates = removeStopwords(preprocess(movieplot));
	x = candidates.length;
	var text = candidates.join(" ");
	var bag = new Set(text.split(" "));
	bag = Array.from(bag);
	bag = bag.slice(1);
	var m = bag.length;
	var freq = [];
	var degree = new Array(m).fill(0);
	for (var i = 0; i < m; i++) {
	freq.push(countInstances(text, " "+bag[i]+" "));
	for (var c = 0; c < x; c++) {
	if (candidates[c].includes(" "+bag[i]+" ")) {
	degree[i] += countInstances(candidates[c], " ") - 1;
	}
	}
	}
	var word_scores = [];
	for (var i = 0; i < m; i++) {
	word_scores.push(degree[i] / freq[i]);
	}
	var candidate_scores = new Array(x).fill(0);
	for (var c = 0; c < x; c++) {
	var candi = candidates[c].slice(1, -1).split(" ");
	for (var i = 0; i < candi.length; i++) {
	var wi = bag.indexOf(candi[i]);
	candidate_scores[c] += word_scores[wi];
	}
	}
	var combination = [];
	for (var i = 1; i < x; i++) {
	combination.push(
	{score: candidate_scores[i], kw: candidates[i].slice(1, -1)}
	);
	}
	combination.sort(function(a, b) {
	return ((a.score > b.score) ? -1 : ((a.score == b.score) ? 0 : 1));
	});
	var temp = [];
	for (var i = 0; i < Math.floor(x/2); i++) {
	temp.push(combination[i].kw);
	}
	var combination = [];
	for (var i = 0; i < 20; i++) {
	if (combination.includes(temp[i]) == false) {
	combination.push(temp[i]);
	}
	}
	x = combination.length;
	var keywordresult=[];
	if(combination.length>3){
	for (var i = 0; i < 4; i++) {
	keywordresult.push(combination[Math.floor(Math.random()*(combination.length-0)+0)]);
	}
	}
	else{
	keywordresult=combination;
	}
	keywordresult=[...new Set(keywordresult)];
	return keywordresult;
}
var fox_stoplist = ["a","able","about","above","according","accordingly","across","actually","after","afterwards","again","against","all","allow","allows","almost","alone","along","already","also","although","always","am","among","amongst","an","and","another","any","anybody","anyhow","anyone","anything","anyway","anyways","anywhere","apart","appear","appreciate","appropriate","are","area","areas","around","as","aside","ask","asked","asking","asks","associated","at","available","away","awfully","b","back","backed","backing","backs","be","became","because","become","becomes","becoming","been","before","beforehand","began","behind","being","beings","believe","below","beside","besides","best","better","between","beyond","big","both","brief","but","by","c","came","can","cannot","cant","case","cases","cause","causes","certain","certainly","changes","clear","clearly","co","com","come","comes","concerning","consequently","consider","considering","contain","containing","contains","corresponding","could","course","currently","d","definitely","described","despite","did","differ","different","differently","do","does","doing","done","down","downed","downing","downs","downwards","during","e","each","early","edu","eg","eight","either","else","elsewhere","end","ended","ending","ends","enough","entirely","especially","et","etc","even","evenly","ever","every","everybody","everyone","everything","everywhere","ex","exactly","example","except","f","face","faces","fact","facts","far","felt","few","fifth","find","finds","first","five","followed","following","follows","for","former","formerly","forth","four","from","full","fully","further","furthered","furthering","furthermore","furthers","g","gave","general","generally","get","gets","getting","give","given","gives","go","goes","going","gone","good","goods","got","gotten","great","greater","greatest","greetings","group","grouped","grouping","groups","h","had","happens","hardly","has","have","having","he","hello","help","hence","her","here","hereafter","hereby","herein","hereupon","hers","herself","hi","high","higher","highest","him","himself","his","hither","hopefully","how","howbeit","however","i","ie","if","ignored","immediate","important","in","inasmuch","inc","indeed","indicate","indicated","indicates","inner","insofar","instead","interest","interested","interesting","interests","into","inward","is","it","its","itself","j","just","k","keep","keeps","kept","kind","knew","know","known","knows","l","large","largely","last","lately","later","latest","latter","latterly","least","less","lest","let","lets","like","liked","likely","little","long","longer","longest","look","looking","looks","ltd","m","made","mainly","make","making","man","many","may","maybe","me","mean","meanwhile","member","members","men","merely","might","more","moreover","most","mostly","mr","mrs","much","must","my","myself","n","name","namely","nd","near","nearly","necessary","need","needed","needing","needs","neither","never","nevertheless","new","newer","newest","next","nine","no","nobody","non","none","noone","nor","normally","not","nothing","novel","now","nowhere","number","numbered","numbering","numbers","o","obviously","of","off","often","oh","ok","okay","old","older","oldest","on","once","one","ones","only","onto","open","opened","opening","opens","or","order","ordered","ordering","orders","other","others","otherwise","ought","our","ours","ourselves","out","outside","over","overall","own","p","part","parted","particular","particularly","parting","parts","per","perhaps","place","placed","places","please","plus","point","pointed","pointing","points","possible","present","presented","presenting","presents","presumably","probably","problem","problems","provides","put","puts","q","que","quite","qv","r","rather","rd","re","really","reasonably","regarding","regardless","regards","relatively","respectively","right","room","rooms","s","said","same","saw","say","saying","says","second","secondly","seconds","see","seeing","seem","seemed","seeming","seems","seen","sees","self","selves","sensible","sent","serious","seriously","seven","several","shall","she","should","show","showed","showing","shows","side","sides","since","six","small","smaller","smallest","so","some","somebody","somehow","someone","something","sometime","sometimes","somewhat","somewhere","soon","sorry","specified","specify","specifying","state","states","still","sub","such","sup","sure","t","take","taken","tell","tends","th","than","thank","thanks","thanx","that","thats","the","their","theirs","them","themselves","then","thence","there","thereafter","thereby","therefore","therein","theres","thereupon","these","they","thing","things","think","thinks","third","this","thorough","thoroughly","those","though","thought","thoughts","three","through","throughout","thru","thus","to","today","together","too","took","toward","towards","tried","tries","truly","try","trying","turn","turned","turning","turns","twice","two","u","un","under","unfortunately","unless","unlikely","until","unto","up","upon","us","use","used","useful","uses","using","usually","uucp","v","value","various","very","via","viz","vs","w","want","wanted","wanting","wants","was","way","ways","we","welcome","well","wells","went","were","what","whatever","when","whence","whenever","where","whereafter","whereas","whereby","wherein","whereupon","wherever","whether","which","while","whither","who","whoever","whole","whom","whose","why","will","willing","wish","with","within","without","wonder","work","worked","working","works","would","x","y","year","years","yes","yet","you","young","younger","youngest","your","yours","yourself","yourselves","z","zero"];
String.prototype.replaceAll = function(search, replacement) {
var target = this;
return target.split(search).join(replacement);
};
function preprocess(movieplot) {
var delimiters = ["(", ")", "[", "]", "{", "}", ".", ",", ":", ";", "!", "#", "$", "&", "?", " - ", "_", "+", "<", ">", '“', '”', '–', "…", ' / ', "|", '’', "'"];
var str = movieplot;
str = " " + str + " ";
str = splitMulti(str, delimiters).join(" wwttff ");
return str;
}
function removeStopwords(str) {
n = fox_stoplist.length;
str = str.replaceAll("n't", " not");
str = str.replaceAll("n’t", " not");
str = str.replaceAll("'ve", " have");
str = str.replaceAll('’ve', " have");
str = str.replaceAll('t’s', "t is");
str = str.replaceAll("t's", "t is");
str = str.replaceAll('\n', " wwttff ");
for (var i = 0; i < n; i++) {
str = str.replaceAll(" "+fox_stoplist[i]+" ", " wwttff ");
}
str = str.replace(/\s+/g, ' ');
//str = str.replaceAll("wwttff", "+");
str = str.split("wwttff");
n = str.length;
var candidates = [];
for (var i = 0; i < n; i++) {
if (str[i].length >= 2) {
candidates.push(str[i]);
}
}
return candidates;
}
function countInstances(string, word) {
return string.split(word).length - 1;
}
function splitMulti(str, tokens){
var tempChar = tokens[0]; // We can use the first token as a temporary join character
for(var i = 1; i < tokens.length; i++){
str = str.split(tokens[i]).join(tempChar);
}
str = str.split(tempChar);
return str;
}
function getMatches(string, regex, index) {
index || (index = 1); // default to the first capturing group
var matches = [];
var match;
while (match = regex.exec(string)) {
matches.push(match[index]);
}
return matches;
}



</script>


<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
        <h5 class="modal-title">Modal title</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
			<div class="modal-body text-center">
				<div class="row" id="gifs">
				</div>

			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-danger" data-dismiss="modal"><span class="fa fa-close"></span> Close</button>
			</div>
		</div>
	</div>
</div>
</body>
</html>